<!DOCTYPE html>
<!-- Developed By: Virinchi Balabhadrapatruni
	 Date:  2/10/2015
	 UMass Lowell, GUI II
-->

{% extends "polls/base.html" %} {% block content %}

<div class="jumbotron">
	<h1>My Account</h1>
	<form id="createFrm" method="LINK" action="/create_poll/">
		<button type="submit" class="btn btn-default">
			<span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
			Create New Poll
		</button>
	</form>

	<div class="row">
		<!-- tabs left -->
			<div id="pills">
				<ul class="nav nav-pills">
					<li><a href="#a" data-toggle="tab">My Polls</a></li>
					<li><a href="#c" data-toggle="tab">My Votes</a></li>
					<li class="active"><a href="#b" data-toggle="tab">My
							Account</a></li>
					
				</ul>
			</div>
			<div>
			<div class="tab-content" id="accountTabs">
				<div id="a" class="tab-pane fade">
					<div class="table">
						<table class="table-striped" id="topics">
							<tr>
								<th>Poll</th>
								<th>Date created</th>
								<th class="change">Actions</th>
							</tr>
							{% for p in polls %}
							<tr>
								<td class="change"><a href="/{{ p.category.id }}/{{ p.id }}">{{ p.poll_text }}</a></td>
								<td>{{ p.pub_date }}</td>
								<td>
									<div class="dropdown">
										<button class="btn btn-default dropdown-toggle" type="button"
											id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
											Actions <span class="caret"></span>
										</button>
										<ul class="dropdown-menu" role="menu"
											aria-labelledby="dropdownMenu1">
											<li role="presentation"><a role="menuitem" tabindex="-1"
												href="/freeze_voting/{{p.id}}">Freeze Voting</a></li>
											<li role="presentation"><a role="menuitem" tabindex="-1"
												href='/delete_poll/{{p.id}}'>Delete Poll</a></li>
											<li role="presentation"><a role="menuitem" tabindex="-1"
												href="/view_pdf_summary/{{p.id}}">Generate PDF Summary</a></li>
										</ul>
									</div>
								</td>
							</tr>
							{% endfor %}
						</table>
					</div>
				</div>
				<div class="tab-pane fade active in" id="b">
					<form id="createFrm" method="LINK" action="/user/{{ user.id }}/close/">
						<button type="submit" class="btn btn-default">
							<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
							Close Account
						</button>
					</form>
					<div class="table-responsive">
						<table class="table-striped" id="accountInfo">
							<tr>
								<th>Name:</th>
								<td>{{ user.get_full_name }}</td>
							</tr>
							<tr>
								<th>Username:</th>
								<td><a href="/user/{{ user.id }}/">{{ user.username }}</a></td>
	
							</tr>
							<tr>
								<th>Email Address:</th>
								<td>{{ user.email }}</td>
							</tr>
							<tr>
								<th>Password:</th>
								<td>&#x25CF;&#x25CF;&#x25CF;&#x25CF;&#x25CF;&#x25CF;&#x25CF;
									<form method="LINK" action="/myAccount/password_change/">
										<button id="changePass" type="submit" class="btn btn-default">Change Password</button>
									</form>
								</td>
							</tr>
							<tr>
								<th>Date Joined:</th>
								<td>{{ user.date_joined }}</td>
							</tr>
						</table>
					</div>
					
				</div>
				<div id="c" class="tab-pane fade">
					<div class="table">
						<table class="table-striped" id="topics">
							<tr>
								<th>Poll</th>
								<th>Date created</th>
								<th class="change">Owner</th>
							</tr>
							{% for p in polls_voted %}
							<tr>
								<td class="change"><a href="/{{ p.category.id }}/{{ p.id }}">{{ p.poll_text }}</a></td>
								<td>{{ p.pub_date }}</td>
								{% if p.user.username == user.username %}
									<td><a href="/user/{{ p.user.id }}">Me</a></td>
								{% else %}
									<td><a href="/user/{{ p.user.id }}">{{ p.user.username }}</a></td>
								{% endif %}
							</tr>
							{% endfor %}
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}
